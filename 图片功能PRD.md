# ğŸ“¸ Interactive Feedback MCP - å›¾ç‰‡åŠŸèƒ½äº§å“éœ€æ±‚æ–‡æ¡£ (PRD)

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯
- **ç‰ˆæœ¬**: v1.0
- **åˆ›å»ºæ—¥æœŸ**: 2024å¹´12æœˆ
- **æœ€åæ›´æ–°**: 2024å¹´12æœˆ
- **è´Ÿè´£äºº**: AI Assistant
- **çŠ¶æ€**: è®¾è®¡é˜¶æ®µ

---

## ğŸ¯ äº§å“æ¦‚è¿°

### åŠŸèƒ½å®šä½
Interactive Feedback MCP çš„å›¾ç‰‡åŠŸèƒ½æ—¨åœ¨ä¸ºç”¨æˆ·æä¾›ç›´è§‚ã€é«˜æ•ˆçš„å›¾ç‰‡åˆ†äº«å’Œåé¦ˆèƒ½åŠ›ï¼Œæ”¯æŒç”¨æˆ·é€šè¿‡ç²˜è´´å›¾ç‰‡çš„æ–¹å¼å‘ Cursor ä¼ é€’è§†è§‰ä¿¡æ¯ï¼Œå¢å¼ºäººæœºäº¤äº’çš„è¡¨è¾¾èƒ½åŠ›ã€‚

### æ ¸å¿ƒä»·å€¼
- **ğŸ–¼ï¸ è§†è§‰åŒ–äº¤æµ**: æ”¯æŒç”¨æˆ·é€šè¿‡å›¾ç‰‡ä¼ é€’å¤æ‚çš„è§†è§‰ä¿¡æ¯
- **ğŸš€ æ— ç¼é›†æˆ**: ä¸ç°æœ‰æ–‡æœ¬åé¦ˆç³»ç»Ÿå®Œç¾èåˆ
- **âš¡ é«˜æ•ˆä¼ è¾“**: åŸºäºBase64ç¼–ç çš„å›¾ç‰‡æ•°æ®ä¼ è¾“
- **ğŸ¨ ç”¨æˆ·å‹å¥½**: ç›´è§‚çš„å›¾ç‰‡é¢„è§ˆå’Œç®¡ç†ç•Œé¢

---

## ğŸ”§ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒç»„ä»¶

#### 1. FeedbackTextEdit ç±»
**èŒè´£**: å›¾ç‰‡è¾“å…¥å’Œå¤„ç†çš„æ ¸å¿ƒç»„ä»¶

```python
class FeedbackTextEdit(QTextEdit):
    # å›¾ç‰‡å¤„ç†å¸¸é‡
    DEFAULT_MAX_IMAGE_WIDTH = 1624
    DEFAULT_MAX_IMAGE_HEIGHT = 1624
    DEFAULT_IMAGE_FORMAT = "PNG"
    
    # ä¿¡å·å®šä¹‰
    image_pasted = Signal(QPixmap)
```

**å…³é”®ç‰¹æ€§**:
- æ”¯æŒå‰ªè´´æ¿å›¾ç‰‡ç²˜è´´
- è‡ªåŠ¨å›¾ç‰‡æ ¼å¼è½¬æ¢
- Base64ç¼–ç å¤„ç†
- é«˜DPIå±å¹•æ”¯æŒ

#### 2. å›¾ç‰‡æ•°æ®ç»“æ„
```python
class FeedbackResult(TypedDict):
    interactive_feedback: str
    images: List[str]  # Base64ç¼–ç çš„å›¾ç‰‡æ•°æ®åˆ—è¡¨
```

### æ•°æ®æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·ç²˜è´´å›¾ç‰‡] --> B[insertFromMimeData]
    B --> C[æ£€æµ‹å›¾ç‰‡æ•°æ®]
    C --> D[è½¬æ¢ä¸ºQPixmap]
    D --> E[Base64ç¼–ç ]
    E --> F[å­˜å‚¨åˆ°image_data]
    F --> G[å‘é€image_pastedä¿¡å·]
    G --> H[UIæ˜¾ç¤ºé¢„è§ˆ]
    H --> I[ç”¨æˆ·æäº¤åé¦ˆ]
    I --> J[è¿”å›FeedbackResult]
```

---

## ğŸ¨ ç”¨æˆ·ç•Œé¢è®¾è®¡

### å›¾ç‰‡é¢„è§ˆåŒºåŸŸ

#### å¸ƒå±€ä½ç½®
- **ä½ç½®**: ä¸­é—´æ ï¼ˆæ™ºèƒ½æ¨èé€‰é¡¹é¢æ¿ï¼‰
- **æ’åˆ—**: ä½äºæ™ºèƒ½æ¨èé€‰é¡¹åˆ—è¡¨çš„æœ€åé¢
- **é›†æˆæ–¹å¼**: ä¸é€‰é¡¹åˆ—è¡¨æ— ç¼é›†æˆï¼Œä¿æŒä¸€è‡´çš„è§†è§‰é£æ ¼

#### å¸ƒå±€è§„èŒƒ
- **å®¹å™¨é«˜åº¦**: 80px å›ºå®šé«˜åº¦
- **å›¾ç‰‡é—´è·**: 5px
- **å†…è¾¹è·**: 5px (ä¸Šä¸‹å·¦å³)
- **å¯¹é½æ–¹å¼**: å·¦å¯¹é½ï¼Œå‚ç›´å±…ä¸­
- **æ»šåŠ¨æ”¯æŒ**: æ°´å¹³æ»šåŠ¨æŸ¥çœ‹å¤šå¼ å›¾ç‰‡
- **æ˜¾ç¤ºé€»è¾‘**: ä»…åœ¨æœ‰å›¾ç‰‡æ—¶æ˜¾ç¤ºï¼Œæ— å›¾ç‰‡æ—¶éšè—

#### å›¾ç‰‡æ˜¾ç¤ºè§„åˆ™
```python
# ç¼©æ”¾ç®—æ³•
target_height = 80  # å›ºå®šé«˜åº¦
scaled_width = int(original_width * (target_height / original_height))

# ä¿æŒå®½é«˜æ¯”ç¼©æ”¾
scaled_pixmap = pixmap.scaled(
    scaled_width,
    target_height,
    Qt.KeepAspectRatio,
    Qt.SmoothTransformation
)
```

#### åˆ é™¤æŒ‰é’®è®¾è®¡
- **ä½ç½®**: å›¾ç‰‡å³ä¸Šè§’æ‚¬æµ®
- **å°ºå¯¸**: 18x18px
- **æ ·å¼**: çº¢è‰²åœ†å½¢èƒŒæ™¯ï¼Œç™½è‰²"Ã—"ç¬¦å·
- **äº¤äº’**: æ‚¬åœæ—¶èƒŒæ™¯å˜ä¸ºçº¯çº¢è‰²

### å“åº”å¼è®¾è®¡

#### é«˜DPIå±å¹•æ”¯æŒ
```python
device_pixel_ratio = QApplication.primaryScreen().devicePixelRatio()
if device_pixel_ratio > 1.0:
    # åˆ›å»ºé«˜åˆ†è¾¨ç‡pixmap
    hires_pixmap = pixmap.scaled(
        hires_scaled_width,
        hires_target_height,
        Qt.KeepAspectRatio,
        Qt.SmoothTransformation
    )
    hires_pixmap.setDevicePixelRatio(device_pixel_ratio)
```

---

## âš™ï¸ åŠŸèƒ½è§„æ ¼

### å›¾ç‰‡è¾“å…¥åŠŸèƒ½

#### æ”¯æŒçš„è¾“å…¥æ–¹å¼
1. **å‰ªè´´æ¿ç²˜è´´** (ä¸»è¦æ–¹å¼)
   - å¿«æ·é”®: `Ctrl+V` / `Cmd+V`
   - æ”¯æŒä»ä»»ä½•åº”ç”¨ç¨‹åºå¤åˆ¶çš„å›¾ç‰‡
   - è‡ªåŠ¨æ£€æµ‹MIMEæ•°æ®ä¸­çš„å›¾ç‰‡å†…å®¹

#### æ”¯æŒçš„å›¾ç‰‡æ ¼å¼
- **è¾“å…¥æ ¼å¼**: æ‰€æœ‰QPixmapæ”¯æŒçš„æ ¼å¼
  - PNG, JPEG, BMP, GIF, TIFFç­‰
- **è¾“å‡ºæ ¼å¼**: PNG (ç»Ÿä¸€è½¬æ¢)
- **ç¼–ç æ–¹å¼**: Base64å­—ç¬¦ä¸²

#### å›¾ç‰‡å¤„ç†è§„æ ¼
```python
# å›¾ç‰‡è½¬æ¢å‚æ•°
DEFAULT_MAX_IMAGE_WIDTH = 1624   # æœ€å¤§å®½åº¦
DEFAULT_MAX_IMAGE_HEIGHT = 1624  # æœ€å¤§é«˜åº¦
DEFAULT_IMAGE_FORMAT = "PNG"     # è¾“å‡ºæ ¼å¼
```

### å›¾ç‰‡ç®¡ç†åŠŸèƒ½

#### å›¾ç‰‡é¢„è§ˆåŠŸèƒ½
- **å®æ—¶é¢„è§ˆ**: å›¾ç‰‡ç²˜è´´åç«‹å³åœ¨ä¸­é—´æ æ˜¾ç¤ºé¢„è§ˆ
- **ç¼©ç•¥å›¾æ˜¾ç¤º**: æŒ‰æ¯”ä¾‹ç¼©æ”¾åˆ°80pxé«˜åº¦ï¼Œä¿æŒå®½é«˜æ¯”
- **å¤šå›¾ç‰‡æ”¯æŒ**: æ”¯æŒå¤šå¼ å›¾ç‰‡çš„æ°´å¹³æ’åˆ—æ˜¾ç¤º
- **é¢„è§ˆè´¨é‡**: é«˜æ¸…é¢„è§ˆï¼Œæ”¯æŒé«˜DPIå±å¹•æ˜¾ç¤º

#### å›¾ç‰‡å­˜å‚¨
```python
image_info = {
    'base64': image_result['data'],      # Base64ç¼–ç æ•°æ®
    'filename': filename                 # ç”Ÿæˆçš„å”¯ä¸€æ–‡ä»¶å
}
```

#### æ–‡ä»¶åç”Ÿæˆè§„åˆ™
```python
timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
unique_id = str(uuid.uuid4())[:8]
filename = f"pasted_image_{timestamp}_{unique_id}.{extension}"
```

#### å›¾ç‰‡åˆ é™¤åŠŸèƒ½
- **è§¦å‘æ–¹å¼**: ç‚¹å‡»å›¾ç‰‡å³ä¸Šè§’åˆ é™¤æŒ‰é’®
- **åˆ é™¤èŒƒå›´**: 
  - ä»UIé¢„è§ˆåŒºåŸŸç§»é™¤
  - ä»image_dataåˆ—è¡¨ä¸­åˆ é™¤
  - é‡Šæ”¾ç›¸å…³å†…å­˜èµ„æº
- **è‡ªåŠ¨éšè—**: å½“æ‰€æœ‰å›¾ç‰‡è¢«åˆ é™¤æ—¶ï¼Œè‡ªåŠ¨éšè—é¢„è§ˆå®¹å™¨

#### ä¸­é—´æ é›†æˆè®¾è®¡
```python
# åœ¨ä¸­é—´æ å¸ƒå±€ä¸­æ·»åŠ å›¾ç‰‡é¢„è§ˆåŒºåŸŸ
def _create_center_panel(self):
    # ... æ™ºèƒ½æ¨èé€‰é¡¹ ...
    
    # å›¾ç‰‡é¢„è§ˆåŒºåŸŸ - ä½äºé€‰é¡¹åˆ—è¡¨æœ€å
    self.images_container = QFrame()
    self.images_container.setStyleSheet("""
        QFrame {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            margin: 5px 0px;
        }
    """)
    self.images_container.setFixedHeight(90)  # åŒ…å«è¾¹è·çš„æ€»é«˜åº¦
    self.images_container.setVisible(False)  # é»˜è®¤éšè—
    
    layout.addWidget(self.images_container)
```

---

## ğŸ”„ æ•°æ®ä¼ è¾“

### è¾“å‡ºæ•°æ®æ ¼å¼

#### FeedbackResultç»“æ„
```python
{
    "interactive_feedback": "ç”¨æˆ·çš„æ–‡æœ¬åé¦ˆå†…å®¹",
    "images": [
        "iVBORw0KGgoAAAANSUhEUgAA...",  # Base64ç¼–ç çš„å›¾ç‰‡1
        "iVBORw0KGgoAAAANSUhEUgAA...",  # Base64ç¼–ç çš„å›¾ç‰‡2
        # ... æ›´å¤šå›¾ç‰‡
    ]
}
```

#### ä¸Cursorçš„é›†æˆ
- **ä¼ è¾“æ–¹å¼**: JSONæ ¼å¼æ•°æ®
- **å›¾ç‰‡ç¼–ç **: Base64å­—ç¬¦ä¸²æ•°ç»„
- **æ–‡æœ¬ç»“åˆ**: å›¾ç‰‡ä¸æ–‡æœ¬åé¦ˆåŒæ—¶ä¼ è¾“
- **é¡ºåºä¿æŒ**: å›¾ç‰‡æŒ‰ç²˜è´´é¡ºåºæ’åˆ—

---

## ğŸ¯ ç”¨æˆ·ä½“éªŒè®¾è®¡

### äº¤äº’æµç¨‹

#### æ ‡å‡†ä½¿ç”¨æµç¨‹
1. **å›¾ç‰‡ç²˜è´´**
   - ç”¨æˆ·åœ¨å…¶ä»–åº”ç”¨ä¸­å¤åˆ¶å›¾ç‰‡
   - åœ¨å·¦ä¾§æ¶ˆæ¯å†…å®¹çš„æ–‡æœ¬æ¡†ä¸­æŒ‰ `Ctrl+V`
   - ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹å¹¶å¤„ç†å›¾ç‰‡

2. **å›¾ç‰‡é¢„è§ˆ**
   - ä¸­é—´æ çš„å›¾ç‰‡é¢„è§ˆåŒºåŸŸè‡ªåŠ¨æ˜¾ç¤º
   - å›¾ç‰‡æŒ‰ç²˜è´´é¡ºåºä»å·¦åˆ°å³æ’åˆ—
   - ä½äºæ™ºèƒ½æ¨èé€‰é¡¹åˆ—è¡¨çš„æœ€åé¢
   - æ”¯æŒæ°´å¹³æ»šåŠ¨æŸ¥çœ‹å¤šå¼ å›¾ç‰‡

3. **å›¾ç‰‡ç®¡ç†**
   - æ‚¬åœæ˜¾ç¤ºåˆ é™¤æŒ‰é’®
   - ç‚¹å‡»åˆ é™¤ä¸éœ€è¦çš„å›¾ç‰‡
   - å®æ—¶æ›´æ–°ä¸­é—´æ é¢„è§ˆåŒºåŸŸ
   - æ— å›¾ç‰‡æ—¶è‡ªåŠ¨éšè—é¢„è§ˆåŒºåŸŸ

4. **åé¦ˆæäº¤**
   - å›¾ç‰‡è‡ªåŠ¨åŒ…å«åœ¨åé¦ˆç»“æœä¸­
   - ä¸æ–‡æœ¬å†…å®¹å’Œé€‰æ‹©çš„é€‰é¡¹ä¸€èµ·å‘é€ç»™Cursor

### è§†è§‰åé¦ˆ

#### çŠ¶æ€æŒ‡ç¤º
- **ç©ºçŠ¶æ€**: ä¸­é—´æ é¢„è§ˆåŒºåŸŸéšè—ï¼Œä¸å½±å“é€‰é¡¹åˆ—è¡¨å¸ƒå±€
- **æœ‰å›¾ç‰‡**: ä¸­é—´æ é¢„è§ˆåŒºåŸŸæ˜¾ç¤ºåœ¨é€‰é¡¹åˆ—è¡¨æœ€åï¼Œå›¾ç‰‡å·¦å¯¹é½
- **æ‚¬åœçŠ¶æ€**: åˆ é™¤æŒ‰é’®é«˜äº®æ˜¾ç¤ºï¼Œä¸æ¯›ç»ç’ƒä¸»é¢˜ä¸€è‡´
- **åˆ é™¤åŠ¨ç”»**: å›¾ç‰‡ç§»é™¤æ—¶çš„å¹³æ»‘è¿‡æ¸¡ï¼Œä¿æŒç•Œé¢æµç•…æ€§
- **é›†æˆçŠ¶æ€**: é¢„è§ˆåŒºåŸŸä¸æ™ºèƒ½æ¨èé€‰é¡¹ä¿æŒä¸€è‡´çš„è§†è§‰é£æ ¼

#### é”™è¯¯å¤„ç†
```python
try:
    # å›¾ç‰‡å¤„ç†é€»è¾‘
except Exception as e:
    print(f"å¤„ç†å›¾ç‰‡æ—¶å‡ºé”™: {e}")
    cursor.insertText(f"[å›¾ç‰‡å¤„ç†å¤±è´¥: {str(e)}]")
```

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### å†…å­˜ç®¡ç†
- **å³æ—¶ç¼–ç **: å›¾ç‰‡ç²˜è´´åç«‹å³è½¬æ¢ä¸ºBase64
- **åŸå›¾é‡Šæ”¾**: è½¬æ¢å®Œæˆåé‡Šæ”¾åŸå§‹QPixmap
- **åˆ é™¤æ¸…ç†**: å›¾ç‰‡åˆ é™¤æ—¶åŠæ—¶é‡Šæ”¾å†…å­˜

### æ¸²æŸ“ä¼˜åŒ–
- **ç¼©æ”¾ç¼“å­˜**: é¢„è§ˆå›¾ç‰‡ä½¿ç”¨ç¼“å­˜çš„ç¼©æ”¾ç‰ˆæœ¬
- **é«˜DPIé€‚é…**: æ ¹æ®å±å¹•åƒç´ æ¯”åŠ¨æ€è°ƒæ•´
- **å¹³æ»‘ç¼©æ”¾**: ä½¿ç”¨Qt.SmoothTransformation

### ä¼ è¾“ä¼˜åŒ–
- **æ ¼å¼ç»Ÿä¸€**: ç»Ÿä¸€è½¬æ¢ä¸ºPNGæ ¼å¼
- **å‹ç¼©å¹³è¡¡**: åœ¨è´¨é‡å’Œå¤§å°é—´æ‰¾åˆ°å¹³è¡¡
- **æ‰¹é‡ä¼ è¾“**: å¤šå¼ å›¾ç‰‡ä¸€æ¬¡æ€§ä¼ è¾“

---

## ğŸ”’ æŠ€æœ¯é™åˆ¶

### å½“å‰é™åˆ¶
1. **å›¾ç‰‡å°ºå¯¸**: æœ€å¤§1624x1624åƒç´ 
2. **æ•°é‡é™åˆ¶**: æ— ç¡¬æ€§é™åˆ¶ï¼Œä½†å—å†…å­˜çº¦æŸ
3. **æ ¼å¼æ”¯æŒ**: ä¾èµ–Qtæ”¯æŒçš„æ ¼å¼
4. **è¾“å…¥æ–¹å¼**: ä»…æ”¯æŒå‰ªè´´æ¿ç²˜è´´

### æµè§ˆå™¨å…¼å®¹æ€§
- **æ¡Œé¢åº”ç”¨**: åŸºäºPySide6ï¼Œæ— æµè§ˆå™¨ä¾èµ–
- **è·¨å¹³å°**: æ”¯æŒWindowsã€macOSã€Linux

---

## ğŸ“ˆ æœªæ¥æ‰©å±•

### è®¡åˆ’åŠŸèƒ½
1. **æ‹–æ‹½æ”¯æŒ**: æ”¯æŒæ–‡ä»¶æ‹–æ‹½åˆ°ä¸­é—´æ é¢„è§ˆåŒºåŸŸ
2. **æ–‡ä»¶é€‰æ‹©**: åœ¨ä¸­é—´æ æ·»åŠ æ–‡ä»¶é€‰æ‹©æŒ‰é’®
3. **å›¾ç‰‡ç¼–è¾‘**: åŸºç¡€çš„è£å‰ªã€æ—‹è½¬åŠŸèƒ½
4. **æ ¼å¼é€‰æ‹©**: ç”¨æˆ·å¯é€‰æ‹©è¾“å‡ºæ ¼å¼
5. **å‹ç¼©è®¾ç½®**: å¯è°ƒèŠ‚çš„å›¾ç‰‡è´¨é‡è®¾ç½®
6. **é¢„è§ˆå¢å¼º**: æ”¯æŒå›¾ç‰‡æ”¾å¤§æŸ¥çœ‹åŠŸèƒ½
7. **æ‰¹é‡æ“ä½œ**: ä¸­é—´æ æ”¯æŒæ‰¹é‡å›¾ç‰‡ç®¡ç†

### æŠ€æœ¯æ”¹è¿›
1. **å¼‚æ­¥å¤„ç†**: å¤§å›¾ç‰‡çš„å¼‚æ­¥è½¬æ¢
2. **è¿›åº¦æŒ‡ç¤º**: å¤„ç†è¿›åº¦çš„å¯è§†åŒ–åé¦ˆ
3. **æ‰¹é‡æ“ä½œ**: å¤šå›¾ç‰‡çš„æ‰¹é‡ç®¡ç†
4. **äº‘ç«¯å­˜å‚¨**: å¯é€‰çš„äº‘ç«¯å›¾ç‰‡å­˜å‚¨

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### åŠŸèƒ½æµ‹è¯•
- **å›¾ç‰‡ç²˜è´´**: å„ç§æ ¼å¼å›¾ç‰‡çš„ç²˜è´´æµ‹è¯•
- **é¢„è§ˆæ˜¾ç¤º**: ä¸åŒå°ºå¯¸å›¾ç‰‡çš„æ˜¾ç¤ºæ•ˆæœ
- **åˆ é™¤åŠŸèƒ½**: å›¾ç‰‡åˆ é™¤çš„å®Œæ•´æ€§æµ‹è¯•
- **æ•°æ®ä¼ è¾“**: Base64ç¼–ç çš„æ­£ç¡®æ€§éªŒè¯

### æ€§èƒ½æµ‹è¯•
- **å†…å­˜ä½¿ç”¨**: å¤šå›¾ç‰‡åœºæ™¯ä¸‹çš„å†…å­˜å ç”¨
- **å“åº”é€Ÿåº¦**: å›¾ç‰‡å¤„ç†çš„å“åº”æ—¶é—´
- **é«˜DPIæµ‹è¯•**: ä¸åŒåƒç´ æ¯”å±å¹•çš„æ˜¾ç¤ºæ•ˆæœ

### å…¼å®¹æ€§æµ‹è¯•
- **æ“ä½œç³»ç»Ÿ**: Windowsã€macOSã€Linux
- **å±å¹•åˆ†è¾¨ç‡**: ä¸åŒåˆ†è¾¨ç‡å’ŒDPIè®¾ç½®
- **å›¾ç‰‡æ¥æº**: ä¸åŒåº”ç”¨ç¨‹åºå¤åˆ¶çš„å›¾ç‰‡

---

## ğŸ“Š æˆåŠŸæŒ‡æ ‡

### ç”¨æˆ·ä½“éªŒæŒ‡æ ‡
- **ç²˜è´´æˆåŠŸç‡**: >99%
- **é¢„è§ˆåŠ è½½æ—¶é—´**: <500ms
- **åˆ é™¤å“åº”æ—¶é—´**: <100ms
- **å†…å­˜ä½¿ç”¨æ•ˆç‡**: å•å¼ å›¾ç‰‡<10MBå†…å­˜å ç”¨

### æŠ€æœ¯æŒ‡æ ‡
- **Base64è½¬æ¢å‡†ç¡®ç‡**: 100%
- **é«˜DPIé€‚é…è¦†ç›–ç‡**: 100%
- **é”™è¯¯å¤„ç†è¦†ç›–ç‡**: >95%
- **è·¨å¹³å°å…¼å®¹æ€§**: 100%

---

## ğŸ”§ å®ç°ç»†èŠ‚

### å…³é”®ä»£ç ç‰‡æ®µ

#### å›¾ç‰‡ç²˜è´´å¤„ç†
```python
def insertFromMimeData(self, source_data):
    if source_data.hasImage():
        image = source_data.imageData()
        if image:
            image_result = self._convert_image_to_base64(image)
            if image_result:
                # ç”Ÿæˆæ–‡ä»¶åå¹¶ä¿å­˜
                timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                unique_id = str(uuid.uuid4())[:8]
                filename = f"pasted_image_{timestamp}_{unique_id}.{image_result['extension']}"
                
                image_info = {
                    'base64': image_result['data'],
                    'filename': filename
                }
                self.image_data.append(image_info)
                self.image_pasted.emit(pixmap)
```

#### Base64è½¬æ¢
```python
def _convert_image_to_base64(self, image):
    if not isinstance(image, QPixmap):
        pixmap = QPixmap.fromImage(image)
    else:
        pixmap = image
    
    buffer = QBuffer()
    buffer.open(QIODevice.WriteOnly)
    pixmap.save(buffer, self.image_format)
    
    byte_array = buffer.data()
    base64_string = base64.b64encode(byte_array).decode('utf-8')
    buffer.close()
    
    return {
        'data': base64_string,
        'extension': self.image_format.lower()
    }
```

---

## ğŸ“ æ€»ç»“

Interactive Feedback MCP çš„å›¾ç‰‡åŠŸèƒ½ä¸ºç”¨æˆ·æä¾›äº†å¼ºå¤§è€Œç›´è§‚çš„è§†è§‰äº¤æµèƒ½åŠ›ã€‚é€šè¿‡å°†å›¾ç‰‡é¢„è§ˆåŠŸèƒ½é›†æˆåˆ°ä¸­é—´æ çš„æ™ºèƒ½æ¨èé€‰é¡¹åŒºåŸŸï¼Œå®ç°äº†åŠŸèƒ½çš„æ— ç¼æ•´åˆå’Œç•Œé¢çš„ç»Ÿä¸€æ€§ã€‚

### ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿
- **ğŸ¨ ç•Œé¢ç»Ÿä¸€**: å›¾ç‰‡é¢„è§ˆä¸æ™ºèƒ½æ¨èé€‰é¡¹ä¿æŒä¸€è‡´çš„æ¯›ç»ç’ƒè§†è§‰é£æ ¼
- **ğŸ“ ä½ç½®ä¼˜åŒ–**: ä¸­é—´æ å¸ƒå±€è®©å›¾ç‰‡é¢„è§ˆæ›´åŠ ç›´è§‚å’Œæ˜“äºç®¡ç†
- **âš¡ å®æ—¶åé¦ˆ**: å›¾ç‰‡ç²˜è´´åç«‹å³åœ¨ä¸­é—´æ æ˜¾ç¤ºï¼Œæä¾›å³æ—¶çš„è§†è§‰ç¡®è®¤
- **ğŸ”„ æ™ºèƒ½éšè—**: æ— å›¾ç‰‡æ—¶è‡ªåŠ¨éšè—ï¼Œä¸å½±å“æ­£å¸¸çš„é€‰é¡¹åˆ—è¡¨å¸ƒå±€

### ğŸš€ æŠ€æœ¯åˆ›æ–°
é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„ç”¨æˆ·ç•Œé¢å’Œé«˜æ•ˆçš„æ•°æ®å¤„ç†æœºåˆ¶ï¼Œç”¨æˆ·å¯ä»¥è½»æ¾åœ°å°†å›¾ç‰‡ä¿¡æ¯ä¼ é€’ç»™ Cursorï¼Œå¤§å¤§å¢å¼ºäº†äººæœºäº¤äº’çš„è¡¨è¾¾èƒ½åŠ›å’Œæ•ˆç‡ã€‚ä¸­é—´æ çš„é›†æˆè®¾è®¡æ—¢ä¿æŒäº†ç•Œé¢çš„ç®€æ´æ€§ï¼Œåˆæä¾›äº†å¼ºå¤§çš„å›¾ç‰‡ç®¡ç†åŠŸèƒ½ã€‚

è¯¥åŠŸèƒ½çš„æˆåŠŸå®ç°ä¸ºæœªæ¥æ›´å¤šè§†è§‰åŒ–äº¤äº’åŠŸèƒ½å¥ å®šäº†åšå®çš„æŠ€æœ¯åŸºç¡€ï¼Œæ˜¯ Interactive Feedback MCP äº§å“ç”Ÿæ€ä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚ 